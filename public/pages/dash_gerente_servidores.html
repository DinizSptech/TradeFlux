<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TradeFlux - Servidores</title>
  <link rel="stylesheet" href="../css/cadastroUsuario.css">
  <link rel="stylesheet" href="../css/menuLateralAlternativo.css" />
  <link rel="stylesheet" href="../css/dash_gerente_funcionarios_alt.css" />
  <link rel="stylesheet" href="../css/modalPerfil.css" />
  <link rel="stylesheet" href="../css/mobileGerente.css" />
  <link rel="stylesheet" href="../css/mobileComponenteServidor.css" />
  <link rel="stylesheet" href="../css/mobileModais.css" />
  <!-- <script src="../script/sessao.js"></script> -->
   
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="shortcut icon" href="../assets/TRADEFLUX__2_cortado.png" type="image/x-icon">
    <script src="../js/cadastroUsuario.js" defer></script>
    <script src="../js/criacaoMenuLateral.js"></script>
    <script src="../js/mobileGerente.js"></script>
    
    <script src="../js/modais.js"></script>
  <!-- <script src="../script/cadastroFuncionario.js" defer></script> -->
</head>

<body onload="carregarMenuLateral();renderizarModalUsuario(); exibirServidores()">
  <div id="sistema_modais">
  </div>
  <div class="navbar" id="div_navbar">
    <i onclick="mudarIcone()" id="menu-bar">&#9776;</i> 
    <div class="container_perfil_menu" id="modal_perfil">
      <i class="fa-solid fa-bell" onclick="abrirModal('notificacoes')"></i>
      <span class="barraVertical"></span>
      <div class="button_perfil_nav_bar" onclick="abrirModal('perfil')">
      <img class="imgPerfil" id="rogerioCientista2" style="display: none; border-radius: 50%;" src="../assets/icons_protopersonas/rogerioCientista.png" alt="" height="80"/>
      <img class="imgPerfil" id="jenniferADM2"      style="display: none; border-radius: 50%;" src="../assets/icons_protopersonas/jenniferADM.png" alt="" height="80"/>
      <img class="imgPerfil" id="juliaAnalista2"    style="display: none; border-radius: 50%;" src="../assets/icons_protopersonas/juliaAnalista.png" alt="" height="80"/>
        <i class="fa-solid fa-chevron-down"></i>
      </div>
    </div>
</div>
  <main class="container-main" id="main_page">
          <div class="bgForm" id="bg_formulario_edicao">
            <div class="formUsuario">
              <div class="tituloForm">Editar Servidor</div>
              <div class="input">
                <span>Servidor:</span>
                <input id="ipt_nome" type="text" />
              </div>
              <div class="input">
            <span>Quantidade de componentes:</span>
            <input id="ipt_qtdComponentesEdicao" type="text" />
          </div>
          <div class="buttonCadastrar">
            <button onclick="fecharModal('edicao')">Salvar</button>
          </div>
        </div>
  </div>
    <div id="barralateral" class="barra-lateral">
    </div>
    <div class="mainContent">
      <div class="container-title">
        <p>Servidores</p>
      </div>
      <div id="div_containerEsteiras" class="containerEsteiras">
        <table id="tabelaFuncionarios" class="tabelaDados">
          <thead>
            <tr>
              <th>Servidor</th>
              <th>Componentes cadastrados</th>
              <th>Status</th>
              <th>Alertas Hoje</th>
              <th class='tableIcons'>Editar</th>
              <th class='tableIcons'>Excluir</th>
            </tr>
          </thead>
          <tbody id="bodyTabela"></tbody>
        </table>
      </div>
    </div>
  </main>
</body>

</html>
<script>

    // var resultado = [
    //     {
    //         nome: "Tobias Boss",
    //         nomeFantasia: "B3"

    //     }
    // ]
    
    // var servidor = [
    //     {
    //         idServidor: 1,
    //         nome: "Servidor 1",
    //         componentes: "4",
    //         status: "Estável",
    //         monitoramento: "Ativo",        
    //     },

    //     {
    //         idServidor: 2,
    //         nome: "Servidor 2",
    //         componentes: "4",
    //         status: "Estável",
    //         monitoramento: "Ativo",        
    //     },

    //     {
    //         idServidor: 3,
    //         nome: "Servidor 3",
    //         componentes: "4",
    //         status: "Estável",
    //         monitoramento: "Ativo",        
    //     },
    //     {
    //         idServidor: 4,
    //         nome: "Servidor 4",
    //         componentes: "4",
    //         status: "--",
    //         monitoramento: "Inativo",        
    //     },
        
    // ]

    // function carregarServidor(){
    //     for (var i = 0; i < servidor.length; i++) {
    //         bodyTabela.innerHTML += `
    //         <tr>
    //         <td>${servidor[i].nome}</td>
    //         <td>${servidor[i].componentes}</td>
    //         <td style="color: ${servidor[i].status == 'Estável' ? '#2ecc71' : servidor[i].status == 'Perigo' ? '#f39c12' : '#e74c3c'};">${servidor[i].status}</td>
    //         <td style="color: ${servidor[i].monitoramento == 'Ativo' ? '#2ecc71' : '#e74c3c'};">${servidor[i].monitoramento}</td>
    //         <td class='tableIcons'> <i class="fa-solid fa-pencil" onclick="abrirModal('edicao'); editarFuncionario(${servidor[i].idUsuario}, '${servidor[i].nome}', '${servidor[i].email}', '${servidor[i].senha}', '${servidor[i].cargo}', '${servidor[i].status}')" ></i></td>
    //         <td class='tableIcons deletarUser'><i class="fa-solid fa-trash"  onclick='abrirModal('edicao'); deletar(${servidor[i].idUsuario})'></i></td>
    //         </tr>
    //         `
    //     }
        
    // }

    servidores = []
    
    function exibirServidores() {
    const dataCenter = sessionStorage.DataCenter;

  fetch(`/servidores/exibirServidores/${dataCenter}`, {
    method: "GET"
  })
  .then(response => {
    if (response.ok) {
      response.json().then(json => {
        console.log(json);

        servidores = json.map(item => ({
          
          idServidor: item.idServidor,
          totalComponentes: item.totalComponentes,
          status: item.statusServidor,
          alertas: item.alertas_hoje      
      }));


        const bodyTabela = document.getElementById("bodyTabela");
        bodyTabela.innerHTML = ""; 
      
        servidores.forEach(servidor => {
          bodyTabela.innerHTML += `
            <tr>
            <td> Servidor ${servidor.idServidor}</td>
            <td>${servidor.totalComponentes}</td>
            <td style="color: ${servidor.status == 'Estável' ? '#2ecc71' : '#e74c3c'};">${servidor.status}</td>
            <td style="color: ${servidor.alertas == 0 ? '#2ecc71' : '#e74c3c'};">${servidor.alertas}</td>
            <td class='tableIcons'> <i class="fa-solid fa-pencil" onclick="abrirModal('edicao');" ></i></td>
            <td class='tableIcons deletarUser'><i class="fa-solid fa-trash"  onclick='abrirModal('edicao');'></i></td>
            </tr>
            
          `;


        });

      });
    } else {
      console.error('Erro ao obter alertas');
    }
  })
  .catch(error => {
    console.error("Erro na requisição:", error);
  });
}
 

</script>